<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="d3-sankey-circular.js"></script>
  <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
  <!-- <script src="example-data.js"></script> -->
  <script src="d3-tip.js"></script>
  <script src="formtable.js"></script>
  <script src="drilldownpie.js"></script>
  <script src="draw-units.js"></script>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="Scorecard_subplots.js"></script>



  <!-- <link href="https://fonts.googleapis.com/css?family=Roboto:100i" rel="stylesheet"> -->

  <title>Sankey Dashboard for Cost of Quality</title>
  <style>
    header {
      background-color: lightgray;
      color: darkslategray
    }

    body {
      font-family: monospace;
      /*background: #E3D4C1;*/
      /*background: #000;*/
    }

    rect {
      shape-rendering: crispEdges;
    }

    text {
      /*text-shadow: 0 1px 0 #fff;*/
      font-size: 12px;
      /*font-family: 'Roboto', sans-serif;*/
      font-family: monospace;
      /*fill: white;*/
    }

    .plotlytitles {
      font-size: 16px;
      font-family: monospace;
      color: black
    }

    .link {
      fill: none;
    }

    svg {
      /* position: absolute; */
    }

    canvas {
      position: absolute;
      pointer-events: none;
    }

    /* pie chart css */
    .outer-label {
      color: rgba(0, 0, 0, 0.8);
      font-size: 12px;
      font-family: monospace;
      text-align: center;
    }

    .center {
      font-size: 18px;
      text-transform: uppercase;
      /* fill: #fff; */
    }

    path {
      cursor: pointer;
    }

    #graph-container,
    #barcharts_div {
      display: inline;
    }

    #plotly_COQ,
    #plotly_ind {
      display: inline;
    }

    .d3-tip {
      line-height: 1;
      padding: 6px;
      background: cornsilk;
      color: rgba(0, 0, 0, 0.8);
      border-radius: 4px;
      font-size: 12px;
      font-family: monospace;
    }

    .table {
      border-collapse: collapse;
    }

    td {
      padding: 8px;
    }

    th {
      text-align: center
    }

    td.border_bottom {
      border-bottom: 5px solid black;
    }

    hr {
      border-top: 1px solid black
    }

    /* @-webkit-keyframes scale-up {
    from { @include transform(scale(0.95)); opacity: 0; }
    to { @include transform(scale(1)); opacity: 1; }
} */
  </style>
</head>
<center>
  <header>
    <section class="row">
      <div class="col-md-4">Author: <a href="mailto:matthewbrown84@gmail.com?subject=Cost of Quality Dashboard">Matthew
          Brown</a></div>
      <div class="col-md-4"><a href="https://github.com/zukohere/Cost-of-Quality">github repo</a></div>
      <div class="col-md-4"> <a href="https://github.com/zukohere/Cost-of-Quality/blob/main/README.md">README and
          references</a></div>
  </header>

  <body>
    <h1>Sankey Dashboard of Cost of Quality</h1>
</center>
<section class="row">
  <div class="col-md-2"></div>
  <div class="col-md-8"><strong>ABOUT:</strong> The <a href="https://asq.org/quality-resources/cost-of-quality">Cost of
      Quality (COQ)</a> is metric that can aid in targeting efforts
    for continuous improvement, but only where the metric is understood and transparent. <br>
    <br>
    The common components of the COQ are: <br>
    <ul>
      <li>Cost of Good Quality (COGQ)
        <ul>
          <li>Prevention: Design and Development, Purchasing Controls, Manufacturing Controls,
            Preservation/Transportation, User Training</li>
          <li>Appraisal: Inspection and Audit</li>
        </ul>
      </li>
      <li>Cost of Poor Quality (COPQ)
        <ul>
          <li>Internal Failure: Scrap, Rework</li>
          <li>External Failure: Returns, Field Scrap, Field Service</li>
        </ul>
      </li>
    </ul>

    <br>
    To aid in education about the components of the COQ and how to develop a model with visualizations, I developed this
    interactive dashboard to help better illustrate the COQ and its components. For more information, references, and
    applications, see the <a href="https://github.com/zukohere/Cost-of-Quality/blob/main/README.md">README</a>. You can run the basic model by clicking the button below.
    Scroll down or <a href="#AdjustParams">click here</a> to move to the section of the page with model paramater
    adjustment.
    <br><br>
    <strong>The dashboard will run on click of either button. Hover over the title of any visualization for more info.</strong>
  </div>
</section>

<center>
  <hr>
  <div id="Dashboard">
    <h1>Dashboard</h1>
  </div>
  (Run with defaults by clicking this button or <a href="#AdjustParams">adjust input parameters below</a>.)<br>
  <a href="#Dashboard"><button id="killData" onclick="killData()" value="test">Run with Current Values</button></a>

  <div id="block container">
    <!-- Sankey model -->
    <div id="sankey"> <canvas width="1000" height="530"></canvas>
      <svg width="1000" height="100"></svg>
    </div>
    <!-- plotly titles and bullet charts -->
    <svg id="Bullet_titles" width="1000" height="20"></svg>
    <div id=plotly_COQ> </div>
    <!-- Launch Comment goes here -->
    <div id="pre-launch_msg" style="font-size:40px">Dashboard Will Load Here</div>
    <!-- bar and pie charts -->
    <svg id="barcharts" width="530" height="500"></svg>
    <svg id="graph-container" width="400" height="500"></svg>
  </div>
  <!-- Adjust Parameters -->
  <hr color="black">
  <h2>Adjust Any/All Parameters and Launch the Dashboard here</h2>
  <div id="block container">
    <div class="row" id="AdjustParams">

      <a href="#Dashboard"><button id="killData" onclick="killData()" value="test">Update Values & Run</button></a>
    </div>
    <div class="row"><br></div>
    <div class="row"><label for="dataType">Choose a Model Type:</label></div>
    <div class="row" id="AdjustData">
      <select name="dataType" id="dataType" onchange="dataSelect(), formTable()">
        <option value="pfr">Product For Resale</option>
        <option value="mfg">In-House Manufacture</option>
      </select>
    </div>

    <div class="row"><br></div>
    <div class="row" id="userTablesArea">
      <form>
        <div class="col-md-1"></div>
        <div class="col-md-3">
          <div id="costTable" class="table"></div>
        </div>
        <div class="col-md-3">
          <div id="valueTable" class="table"></div>
        </div>
        <div class="col-md-3">
          <label for="modelType">Choose Input Type:</label>
          <select name="modelType" id="modelType" onchange="modelChange()">
            <option value="probVal">Probability</option>
            <option value="knownVal">Known Values</option>
          </select>
          <div id="inputTable" class="table"></div>
        </div>
      </form>
    </div>
  </div>
</center>

<script>
  formTable()
  height = d3.select("#sankey").attr("height")

  // Creates color based on COQ components
  const colorLookup = {
    "COGQ": "DarkSeaGreen",
    "COPQ": "LightCoral",
    "Prevention": "LightBlue",
    "Appraisal": "thistle",
    "Internal Failure": "LightSalmon",
    "External Failure": "PaleVioletRed",
    "Shipping": "LightGray",
    "End User": "LightGreen"
  }

  // let data = data2
  function updateData() {
    // killData()
    // console.log(d3.select("#killData").node().value)
    // d3.selectAll("svg > *").remove();
    // drawUnits(submitData())
    submitData()
    d3.select("#killData").node().value = "allowtime"
  }

  function killData() {
    d3.selectAll("svg > *").remove();
    d3.select("#killData").node().value = "stoptime"
    d3.select("#pre-launch_msg").html("")
    // console.log(d3.select("#killData").node().value)
    // d3.select("#killData").node().value="allowtime"
    setTimeout(function () { updateData(); }, 500)
  }


    // console.log(d3.select("#killData").node().value);
</script>
<!-- <script src="d3.sankey.js"></script> -->


<!-- <script src="Scorecard.js"></script> -->

</body>

</html>